language: python
framework: pytorch
format_version: 0.3.0

name: UNet 2D
description: A 2d U-Net.
authors:
  - Constantin Pape;@bioimage-io
  - Fynn Beuttenm√ºller

cite:
  - text: "Ronneberger, Olaf et al. U-net: Convolutional networks for biomedical image segmentation. MICCAI 2015."
    doi: https://doi.org/10.1007/978-3-319-24574-4_28

documentation: UNet2md
git_repo: https://github.com/bioimage-io/pytorch-bioimage-io/tree/master/specs/models/unet2d
tags: [unet2d, pytorch, nucleus-segmentation]
license: MIT

inputs:
  - name: raw
    axes: bcyx
    data_type: float32
    data_range: [-inf, inf]
    shape: [1, 1, 512, 512]

outputs:
  - name: membrane probability
    axes: bcyx
    data_type: float32
    data_range: [-inf, inf]
    halo: [0, 0, 32, 32]
    shape:
      reference_input: raw
      scale: [1, 1, 1, 1]
      offset: [0, 0, 0, 0]

test_inputs: test_inputs.npy
test_outputs: test_outputs.npy

model:
  source: pybio.torch.models.unet.UNet2d
  kwargs: {input_channels: 1, output_channels: 1}
  covers: []  # todo unet 2d arch image
  dependencies: conda:../environment.yaml

weights:
 - id: default
   name: Nuclei Broad v0
   description: Trained on broad nucleus dataset.
   authors: [Constantin Pape;@bioimage-io]
   covers: [cover0.png]
   source: https://zenodo.org/record/3446812/files/unet2d_weights.torch
   sha256: e4d3885bccbe41cbf6c1d825f3cd2b707c7021ead5593156007e407a16b27cf2
   framework: pytorch
   requires_model_source: true
